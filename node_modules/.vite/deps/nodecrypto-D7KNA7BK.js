import {
  convertTurnkeyApiKeyToJwk
} from "./chunk-J273JOAD.js";
import "./chunk-SZETIQFQ.js";
import "./chunk-N6237SYY.js";
import {
  require_crypto
} from "./chunk-VDEFIFDG.js";
import {
  __toESM
} from "./chunk-MMN2DTB3.js";

// node_modules/@turnkey/api-key-stamper/dist/nodecrypto.mjs
var crypto = __toESM(require_crypto(), 1);
var signWithApiKey = async (input) => {
  const { content, publicKey, privateKey } = input;
  const privateKeyObject = crypto.createPrivateKey({
    // @ts-expect-error -- the key can be a JWK object since Node v15.12.0
    // https://nodejs.org/api/crypto.html#cryptocreateprivatekeykey
    key: convertTurnkeyApiKeyToJwk({
      uncompressedPrivateKeyHex: privateKey,
      compressedPublicKeyHex: publicKey
    }),
    format: "jwk"
  });
  const sign = crypto.createSign("SHA256");
  sign.write(Buffer.from(content));
  sign.end();
  return sign.sign(privateKeyObject, "hex");
};
export {
  signWithApiKey
};
//# sourceMappingURL=nodecrypto-D7KNA7BK.js.map
